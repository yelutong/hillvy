{"version":3,"sources":["webpack:///./src/views/goods/evagoods.vue","webpack:///./src/views/goods/evagoods.vue?f3f9","webpack:///./src/views/goods/evagoods.vue?a5c7"],"names":["qs","require","vImglist","VueCoreImageUpload","computed","mapState","goods_evagoods","data","id","this","getUrlParam","detailId","evaContent","imgList","arrImgId","components","v-imglist","vue-core-image-upload","beforeCreate","document","title","methods","imageAction","index","splice","chooseImage","length","showTip","code","arrData","push","imagePath","imgId","evaGoods","_this","lastImgIds","join","loading","Toast","message","iconClass","duration","$axios","post","api","stringify","order_detail_id","product_id","content","image_ids","headers","content-type","Authorization","token","then","res","close","resData","setTimeout","$router","go","msg","catch","views_goods_evagoods","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","image-data","size","touch","on","touchimg","_v","_l","item","key","src","directives","name","rawName","value","expression","modifiers","trim","placeholder","maxlength","domProps","input","$event","target","composing","blur","$forceUpdate","click","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"iLA2BMA,GAAKC,EAAQ,QAYFC,IACYC,IAE3BC,OACKC,aAAU,WAhBNJ,EAAQ,SACJK,GACbC,KADa,WAEX,OACEC,GAAIC,KAAKC,YAAY,OAAS,GAC9BC,SAAUF,KAAKC,YAAY,cAAgB,GAC3CE,WAAY,GACZC,WACAC,cAGJC,YACEC,YAAad,IACbe,wBAAyBd,KAE3BC,gBACKC,aAAU,WAEfa,aAjBa,WAkBXC,SAASC,MAAQ,QAEnBC,SAEEC,YAFO,SAEKC,GACVd,KAAKI,QAAQW,OAAOD,EAAO,GAC3Bd,KAAKK,SAASU,OAAOD,EAAO,IAG9BE,YAPO,SAOKlB,GAEV,GADgBE,KAAKI,QACTa,QAAU,EACpBjB,KAAKkB,QAAQ,mBAGf,GAAkB,IAAdpB,EAAKqB,MAAerB,EAAKA,MAA6B,IAArBA,EAAKA,KAAKmB,OAA/C,CAIA,IAAMG,EAAUtB,EAAKA,KACrBE,KAAKI,QAAQiB,KAAKD,EAAQ,GAAGE,WAC7BtB,KAAKK,SAASgB,KAAKD,EAAQ,GAAGG,YAL5BvB,KAAKkB,QAAQ,aAQjBM,SAtBO,WAsBI,IAAAC,EAAAzB,KACHG,EAAaH,KAAKG,WAClBE,EAAWL,KAAKK,SAClBqB,EAAa,GAEjB,GAA0B,KAAtBvB,EAAWc,QAAiBd,EAAWc,OAAS,EAClDjB,KAAKkB,QAAQ,mBADf,CAIIb,EAASY,OAAS,IACpBS,EAAarB,EAASsB,KAAK,MAG7B,IAAMC,EAAUC,iBACdC,QAAS,WACTC,UAAW,UACXC,SAAU,MAEZhC,KAAKiC,OAAOC,KAAKlC,KAAKmC,IAAIX,SAAUjC,EAAG6C,WACrCC,gBAAiBrC,KAAKE,SACtBoC,WAAYtC,KAAKD,GACjBwC,QAASpC,EACTqC,UAAWd,GAAc,MAEzBe,SACEC,eAAgB,oCAChBC,cAAiB3C,KAAK4C,SAEvBC,KAAK,SAAAC,GACNlB,EAAQmB,QACR,IAAMC,EAAUF,EAAIhD,KACC,IAAjBkD,EAAQ7B,MAKZM,EAAKP,QAAQ,eAAgB,KAAM,MACnC+B,WAAW,WACTxB,EAAKyB,QAAQC,IAAI,IAChB,OAPD1B,EAAKP,QAAQ8B,EAAQI,OAQtBC,MAAM,SAAAP,GACPlB,EAAQmB,QACRtB,EAAKP,QAAQ,oBC7GNoC,GADEC,OAFjB,WAA0B,IAAAC,EAAAxD,KAAayD,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,gCAA0CF,EAAA,OAAYE,YAAA,aAAuBF,EAAA,aAAkBG,OAAOC,aAAAP,EAAApD,QAAA4D,KAAA,KAAAC,MAAA,UAAsDC,IAAKC,SAAAX,EAAA3C,gBAA4B,GAAA2C,EAAAY,GAAA,KAAAT,EAAA,OAA4BE,YAAA,YAAuBL,EAAAa,GAAAb,EAAA,iBAAAc,EAAAxD,GAA2C,OAAA6C,EAAA,OAAiBY,IAAAzD,EAAA+C,YAAA,oBAAwCF,EAAA,OAAYE,YAAA,MAAAC,OAAyBU,IAAAF,SAAgB,GAAAd,EAAAY,GAAA,KAAAT,EAAA,YAAgCc,aAAaC,KAAA,QAAAC,QAAA,eAAAC,MAAApB,EAAA,WAAAqB,WAAA,aAAAC,WAA8FC,MAAA,KAAalB,YAAA,MAAAC,OAA2BkB,YAAA,oBAAAC,UAAA,OAAoDC,UAAWN,MAAApB,EAAA,YAAyBU,IAAKiB,MAAA,SAAAC,GAAyBA,EAAAC,OAAAC,YAAsC9B,EAAArD,WAAAiF,EAAAC,OAAAT,MAAAG,SAA0CQ,KAAA,SAAAH,GAAyB5B,EAAAgC,mBAAqBhC,EAAAY,GAAA,KAAAZ,EAAAY,GAAA,uBAAoCZ,EAAAY,GAAA,KAAAT,EAAA,UAAmCE,YAAA,aAAAK,IAA6BuB,MAAAjC,EAAAhC,YAAsBgC,EAAAY,GAAA,aAEngCsB,oBCCjB,IAcAC,EAdyBC,EAAQ,OAcjCC,CACEhG,EACAyD,GATF,EAVA,SAAAwC,GACEF,EAAQ,SAaV,KAEA,MAUeG,EAAA,QAAAJ,EAAiB","file":"static/js/19.b7cd469c616f4f02c441.js","sourcesContent":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n  mapState\n} from \"vuex\";\nimport {\n  Toast\n} from \"mint-ui\";\nimport VueCoreImageUpload from \"vue-core-image-upload\";\nimport vImglist from \"@/components/v-imglist\";\nconst qs = require(\"qs\");\nexport default {\n  data() {\n    return {\n      id: this.getUrlParam(\"id\") || \"\",\n      detailId: this.getUrlParam(\"detail-id\") || \"\",\n      evaContent: \"\",\n      imgList: [],\n      arrImgId: []\n    };\n  },\n  components: {\n    \"v-imglist\": vImglist,\n    \"vue-core-image-upload\": VueCoreImageUpload\n  },\n  computed: {\n    ...mapState([\"token\"])\n  },\n  beforeCreate() {\n    document.title = \"评价商品\";\n  },\n  methods: {\n    // 接收子组件传来的点击图片事件\n    imageAction(index) {\n      this.imgList.splice(index, 1);\n      this.arrImgId.splice(index, 1);\n    },\n    // 上传之后的事件\n    chooseImage(data) {\n      const imgList = this.imgList;\n      if (imgList.length >= 8) {\n        this.showTip(\"最多只能上传8张图片\");\n        return;\n      }\n      if (data.code !== 1 || !data.data || data.data.length === 0) {\n        this.showTip(\"上传失败，请重试\");\n        return;\n      }\n      const arrData = data.data;\n      this.imgList.push(arrData[0].imagePath);\n      this.arrImgId.push(arrData[0].imgId);\n    },\n    // 点击发表评价\n    evaGoods() {\n      const evaContent = this.evaContent;\n      const arrImgId = this.arrImgId;\n      let lastImgIds = '';\n      // 先检验和整合数据\n      if (evaContent.length === \"\" || evaContent.length < 5) {\n        this.showTip(\"请至少输入五个字的评价\");\n        return;\n      }\n      if (arrImgId.length > 0) {\n        lastImgIds = arrImgId.join(\",\");\n      }\n      // 通过后开始保存评价\n      const loading = Toast({\n        message: \"保存评价中...\",\n        iconClass: \"loading\",\n        duration: 10000\n      });\n      this.$axios.post(this.api.evaGoods, qs.stringify({\n        order_detail_id: this.detailId,\n        product_id: this.id,\n        content: evaContent,\n        image_ids: lastImgIds || \"\"\n      }), {\n        headers: {\n          \"content-type\": \"application/x-www-form-urlencoded\",\n          \"Authorization\": this.token\n        },\n      }).then(res => {\n        loading.close();\n        const resData = res.data;\n        if (resData.code !== 1) {\n          this.showTip(resData.msg);\n          return;\n        }\n        // 成功后返回\n        this.showTip('评价成功，感谢您的支持！', 1500, 'ok');\n        setTimeout(() => {\n          this.$router.go(-1);\n        }, 1500);\n      }).catch(res => {\n        loading.close();\n        this.showTip(\"评价失败，请稍后重试\");\n      });\n    }\n  }\n};\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/views/goods/evagoods.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"wrapper white page-evagoods\"},[_c('div',{staticClass:\"lay-imgs\"},[_c('v-imglist',{attrs:{\"image-data\":_vm.imgList,\"size\":\"75\",\"touch\":\"delete\"},on:{\"touchimg\":_vm.imageAction}})],1),_vm._v(\" \"),_c('div',{staticClass:\"img-list\"},_vm._l((_vm.imgList),function(item,index){return _c('div',{key:index,staticClass:\"img-box mid-img\"},[_c('img',{staticClass:\"img\",attrs:{\"src\":item}})])}),0),_vm._v(\" \"),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model.trim\",value:(_vm.evaContent),expression:\"evaContent\",modifiers:{\"trim\":true}}],staticClass:\"txa\",attrs:{\"placeholder\":\"感觉这件商品怎么样？来评价几句吧~\",\"maxlength\":\"200\"},domProps:{\"value\":(_vm.evaContent)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.evaContent=$event.target.value.trim()},\"blur\":function($event){_vm.$forceUpdate()}}}),_vm._v(\" \"),_vm._v(\"\\\":this.token}\\\">\\n  \"),_vm._v(\" \"),_c('button',{staticClass:\"btn-submit\",on:{\"click\":_vm.evaGoods}},[_vm._v(\"发表评价\")])])}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler?{\"id\":\"data-v-d63e2558\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/_vux-loader@1.2.9@vux-loader/src/before-template-compiler-loader.js!./node_modules/_vux-loader@1.2.9@vux-loader/src/template-loader.js!./node_modules/_vue-loader@13.7.3@vue-loader/lib/selector.js?type=template&index=0!./src/views/goods/evagoods.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/_extract-text-webpack-plugin@3.0.2@extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-d63e2558\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!px2rem-loader?{\\\"remUnit\\\":50}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/_vux-loader@1.2.9@vux-loader/src/style-loader.js!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=styles&index=0!./evagoods.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/_vux-loader@1.2.9@vux-loader/src/script-loader.js!../../../node_modules/_vux-loader@1.2.9@vux-loader/src/script-loader.js!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./evagoods.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/_vux-loader@1.2.9@vux-loader/src/script-loader.js!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=script&index=0!./evagoods.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-d63e2558\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/_vux-loader@1.2.9@vux-loader/src/before-template-compiler-loader.js!../../../node_modules/_vux-loader@1.2.9@vux-loader/src/template-loader.js!../../../node_modules/_vue-loader@13.7.3@vue-loader/lib/selector?type=template&index=0!./evagoods.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/goods/evagoods.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}