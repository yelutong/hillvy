webpackJsonp([8],{"/Dhb":function(t,e,c){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=c("4YfN"),o=c.n(i),s=c("9rMa"),a=(c("wSez"),c("q35e")),l=c("9yBd"),n=(a.a,l.a,o()({},Object(s.c)(["token"])),{data:function(){return{checkedData:{},canEdit:!1,collectsPageNo:1,collectsPageSize:10,moreCollects:!1,noCollects:!1,loading:!0,collectsList:[]}},components:{"v-loadmore":a.a,"v-nodata":l.a},computed:o()({},Object(s.c)(["token"])),beforeCreate:function(){document.title="我的收藏"},created:function(){this.getCollectsData("first")},methods:{getImgUrl:function(t){return t?"string"==typeof t?t.split(",")[0]:t[0]:""},loadMore:function(){this.loading=!0,this.collectsPageNo+=1,this.getCollectsData()},getCollectsData:function(t){var e=this;this.$axios.get(this.api.getCollects,{headers:{Authorization:this.token},params:{page_no:this.collectsPageNo,page_size:this.collectsPageSize}}).then(function(c){var i=c.data;if(1===i.code){var o=i.content,s=o.page_count,a=o.records||[];if(0===a.length)return e.noCollects=!0,void(e.loading=!0);a.forEach(function(t){var c={id:t.productId,checked:!1,img:e.getImgUrl(t.product.photoMainUrl),title:t.product.name,price:t.product.salePrice};e.collectsList.push(c)}),s<=e.collectsPageNo?(e.loading=!0,e.moreCollects=!1):(e.loading=!1,e.moreCollects=!0)}else t?e.noCollects=!0:(e.moreCollects=!0,e.loading=!1)}).catch(function(c){t?e.noCollects=!0:e.loading=!1})},checkAction:function(t,e){t.checked||(this.collectsList.forEach(function(t){t.checked=!1}),t.checked=!0,this.checkedData.id=t.id,this.checkedData.index=e)},delCollect:function(){var t=this,e=this.checkedData;e.id?this.$axios.get(this.api.removeCollect,{headers:{Authorization:this.token},params:{product_id:e.id}}).then(function(c){1===c.data.code?(t.collectsList.splice(e.index,1),0===t.collectsList.length&&(t.collectsPageNo+=1,t.getCollectsData()),t.showTip("删除收藏成功")):t.showTip("删除收藏失败")}).catch(function(e){t.showTip("删除收藏失败")}):this.showTip("请先选择一个商品")}}}),r={render:function(){var t=this,e=t.$createElement,c=t._self._c||e;return c("div",{staticClass:"wrapper page-collects"},[c("div",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:t.loadMore,expression:"loadMore"}],staticClass:"lay-collects",attrs:{"infinite-scroll-disabled":"loading","infinite-scroll-distance":"100"}},[t._l(t.collectsList,function(e,i){return c("div",{key:i,staticClass:"item"},[t.canEdit?c("div",{staticClass:"chose",on:{click:function(c){t.checkAction(e,i)}}},[c("i",{staticClass:"ico i-cks",class:{checked:e.checked}})]):t._e(),t._v(" "),c("router-link",{staticClass:"detail",attrs:{to:{path:"/goods",query:{id:e.id}}}},[c("div",{staticClass:"img-box"},[c("img",{staticClass:"img",attrs:{src:e.img}})]),t._v(" "),c("div",{staticClass:"info-box"},[c("p",{staticClass:"title"},[t._v(t._s(e.title))]),t._v(" "),c("span",{staticClass:"price"},[t._v("￥"+t._s(e.price))])])])],1)}),t._v(" "),t.noCollects?c("v-nodata",{attrs:{bgcolor:"grey",text:"- 收藏夹空空如也 -"}}):t._e(),t._v(" "),t.moreCollects?c("v-loadmore"):t._e()],2),t._v(" "),t.collectsList.length>0?c("div",{staticClass:"lay-action fix-btom"},[t.canEdit?t._e():c("button",{staticClass:"btn-submit nordu",on:{click:function(e){t.canEdit=!0}}},[t._v("编辑")]),t._v(" "),t.canEdit?c("button",{staticClass:"btn-submit nordu",on:{click:t.delCollect}},[t._v("移除")]):t._e(),t._v(" "),t.canEdit?c("button",{staticClass:"btn-submit nordu done",on:{click:function(e){t.canEdit=!1}}},[t._v("完成")]):t._e()]):t._e()])},staticRenderFns:[]};var d=c("C7Lr")(n,r,!1,function(t){c("o/dk")},null,null);e.default=d.exports},HuRD:function(t,e){},"o/dk":function(t,e){},q35e:function(t,e,c){"use strict";String;var i={props:{bgcolor:{type:String,default:"grey"}}},o={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"v-load-more",class:this.bgcolor},[this._v("加载更多... ")])},staticRenderFns:[]};var s=c("C7Lr")(i,o,!1,function(t){c("HuRD")},null,null);e.a=s.exports}});
//# sourceMappingURL=8.476ee19a513b3bd4dbe9.js.map