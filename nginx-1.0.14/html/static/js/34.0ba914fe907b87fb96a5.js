webpackJsonp([34],{Iwiz:function(t,e){},eKaF:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("3cXf"),s=i.n(a),o=i("4YfN"),n=i.n(o),r=i("9rMa"),c=i("wSez"),l=i("f/tg"),d=i("CKVb"),m=i("gpPJ"),v=i("9yBd"),u=i("UzLt"),h=i("Wf59"),g=i("0tvt"),p=(v.a,u.a,l.a,d.a,m.a,g.a,h.a,n()({},Object(r.c)(["token"])),{data:function(){return{data3:"3",evaTitle:"",type:this.getUrlParam("type")||"",from:this.getUrlParam("from")||"",noList:!1,centerList:[],evaContent:"",imgList:[]}},components:{"v-nodata":v.a,vHeader:u.a,Rater:l.a,Group:d.a,Cell:m.a,"v-imglist":g.a,"vue-core-image-upload":h.a},computed:n()({},Object(r.c)(["token"])),beforeCreate:function(){document.title="订单中心"},created:function(){var t=this.from,e=this.type;"orders"==t&&this.getListFromOrders(e)},watch:{data3:function(t,e){console.log(t)}},methods:{getListFromOrders:function(t){var e="";switch(t){case"exp":e="expList",this.evaTitle="物流查询",document.title="物流查询";break;case"eva":e="evaList",this.evaTitle="订单评价",document.title="订单评价"}var i=JSON.parse(sessionStorage.getItem(e));if(0==i.length)return this.noList=!0,void(this.centerList=[]);this.noList=!1,this.centerList=i,console.log(i)},imageAction:function(t){this.imgList.splice(t,1)},chooseImage:function(t){if(console.log(t),this.imgList.length>=3)this.showTip("最多只能上传3张图片");else if(1===t.code&&t.content&&0!==t.content.length){var e=t.content;this.imgList.push(this.api.urlPic+e[0].path+"/"+e[0].name)}else this.showTip("上传失败，请重试")},evaGoods:function(){var t=this,e=this.evaContent;if(""===e.length||e.length<5)this.showTip("请至少输入五个字的评价");else{var i=Object(c.Toast)({message:"保存评价中...",iconClass:"loading",duration:1e4});this.$axios.post(this.api.otoOrderEva,s()({context:e,orderNumber:this.centerList.orderNo,itemId:this.centerList.conList.id,photoUrls:this.imgList.join(","),score:this.data3>0?this.data3:1}),{headers:{Authorization:this.token,"content-type":"application/json"}}).then(function(e){i.close();var a=e.data;1===a.code?(t.showTip("评价成功，感谢您的支持！",1500,"ok"),setTimeout(function(){t.$router.go(-1)},1500)):t.showTip(a.msg)}).catch(function(e){i.close(),t.showTip("评价失败，请稍后重试")})}}}}),f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper page-ordercenter"},[i("vHeader",{attrs:{title:t.evaTitle}}),t._v(" "),i("div",{staticClass:"lay-goods mt50"},["eva"==t.type&&t.centerList?i("div",{staticClass:"item vertical-view"},[i("div",{staticClass:"horizontal-view"},[i("router-link",{staticClass:"img-box",attrs:{to:{path:"/goods",query:{id:t.centerList.conList.goodsId}}}},[i("img",{staticClass:"img",attrs:{src:t.centerList.conList[0].goodsPhoto}})]),t._v(" "),i("div",[i("p",{domProps:{textContent:t._s(t.limitStrFormat(t.centerList.conList[0].goodsName)+" 等"+t.centerList.num+"件商品的评价")}}),t._v(" "),i("div",[i("group",[i("cell",{staticClass:"eva2 left"},[i("Rater",{attrs:{"font-size":30,"active-color":"#ff4f00"},model:{value:t.data3,callback:function(e){t.data3=e},expression:"data3"}})],1)],1)],1)])],1),t._v(" "),i("div",{staticClass:"page-evagoods"},[i("div",{staticClass:"lay-imgs"},[i("v-imglist",{attrs:{"image-data":t.imgList,size:"75",touch:"delete"},on:{touchimg:t.imageAction}})],1),t._v(" "),i("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:t.evaContent,expression:"evaContent",modifiers:{trim:!0}}],staticClass:"txa",attrs:{placeholder:"本次订单服务怎么样？来评价几句吧~",maxlength:"200"},domProps:{value:t.evaContent},on:{input:function(e){e.target.composing||(t.evaContent=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}}),t._v(" "),i("vue-core-image-upload",{staticClass:"up-load",attrs:{crop:!1,text:"",inputAccept:"image/*",credentials:!1,"max-file-size":10485760,multiple:!1,inputOfFile:"Filedata",url:this.api.uploadGoodsPic},on:{imageuploaded:t.chooseImage}}),t._v(" "),i("button",{staticClass:"btn-submit",on:{click:t.evaGoods}},[t._v("发表评价")])],1)]):i("v-nodata",{attrs:{bgcolor:"grey",text:"- 暂无订单详情 -"}})],1)],1)},staticRenderFns:[]};var L=i("C7Lr")(p,f,!1,function(t){i("Iwiz")},null,null);e.default=L.exports}});
//# sourceMappingURL=34.0ba914fe907b87fb96a5.js.map