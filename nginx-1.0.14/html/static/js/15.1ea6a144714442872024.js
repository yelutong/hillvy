webpackJsonp([15],{R7HN:function(s,e){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAMAAAAp4XiDAAAAkFBMVEUAAAD/TgD/TwD/UAD/TwD/TwD/TAD/TwD/TgD/TwD//////fz/9/T/h2b/tKP/3NT/8On/9vH/8uz/7eX/+/n/+vj/ybz/5d//n4b/bT3/qpX/k3f/elP/XiP/Vwz/0sj/vqD/hlD/fUL/6d//5dn/v7D/vJ7/sY//q4X/p3//ZR//oHX/m27/kWD/XRX/UQNTHSihAAAACXRSTlMA0MgGbvQb+W971P08AAABkElEQVRIx9XWyXaCMACFYepQe28ghhYZHVvnTu//dsWA0JIaxFX7b1zId0hyEo3jOP1Bb4irGvYGfSfv/g4durvP32EKu+k7A3Rs4PS6kp4z6kpGDjr398nr2rX2sm+SN7a2axBFPxC2JvQbZMKALakGeaRgneuWn9/Jk41Es2khEi+6koRAzDwJhFcSxvrZCMgsA/NrspEyBTIpp0AqZXiJkP6ERfiZR52gaJB9bYDEq0rglYLbBsFK0RclkaySBQnov5vb8kPRvUQE1REmwTPFZfIMk9SrBsTjqhienvr8d6IYmCtmJfP8G5NYB7YsN3PmLZhAnuyYoZfqBVvPTXLcUohqJwNhQfIUKSZ8WTXJSpCVoATUmSww1YYH41SKWkR6BppoTm0C41TWo5IoHi62foyk5VRG8QyY6e07RZJKD8hazksOUJ7FFEWLFjJGNj6PcCNPRbQQWyZx24k5fVdYC4yfvgNbWzYIdsq1ppaf/+YvqQMZdRXDG64KN1xIbrj23HC5yus/XH+Fe8jf8QWBQ2RRhCWftAAAAABJRU5ErkJggg=="},"Z/u3":function(s,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t("HzJ8"),i=t.n(a),o=t("3cXf"),n=t.n(o),r=t("4YfN"),c=t.n(r),d=t("9rMa"),h=(t("wSez"),t("4s6/")),l=t("CKVb"),g=t("gpPJ"),p=t("9yBd"),u=t("UzLt"),v=(t("6iV/"),h.a,l.a,g.a,p.a,u.a,c()({},Object(d.c)(["token","autoAddress","choseAddress"]),{totalPrice:function(){var s=this,e={goodsCarts:this.goodsCarts,goodsChannel:1==this.isUseIntegral?2:1,isUseIntegral:this.isUseIntegral,userCouponIds:this.userCouponIds};return this.$axios.post(this.api.orderPriceNew,n()(e),{headers:{Authorization:this.token,"content-type":"application/json"}}).then(function(t){var a=t.data;if(1!==a.code)return s.showTip(a.msg),void setTimeout(function(){s.$router.push({path:"/index"})},1500);2==e.goodsChannel?a.content.exchange?a.content.exchange.userIntegral>=a.content.exchange.goodsIntegral?(s.payPrice=a.content.payPrice,s.goodsIntegral=a.content.exchange.goodsIntegral):(s.showTip("兑换积分不足"),s.isUseIntegral="0",s.goodsIntegral="",s.payPrice=a.content.payPrice):(s.showTip("该商品暂不支持积分兑换"),s.isUseIntegral="0",s.goodsIntegral="",s.payPrice=a.content.payPrice):(s.goodsIntegral="",s.payPrice=a.content.payPrice)}).catch(function(s){}),this.payPrice}}),t("6iV/"),{data:function(){return{show:!1,userAddressId:"",areaId:"",isShowList:!1,goodsCarts:[],payPrice:0,userCouponIds:[],goodsChannel:1,goodsIntegral:"",isUseIntegral:!1,exchangeObj:"",exchangePic:t("R7HN"),num:"",showAddress:null,goodsBuyInfo:[],goodsTips:""}},components:{"x-switch":h.a,group:l.a,cell:g.a,"v-nodata":p.a,vHeader:u.a},computed:c()({},Object(d.c)(["token","autoAddress","choseAddress"]),{totalPrice:function(){var s=this,e={goodsCarts:this.goodsCarts,goodsChannel:1==this.isUseIntegral?2:1,isUseIntegral:this.isUseIntegral,userCouponIds:this.userCouponIds};return this.$axios.post(this.api.orderPriceNew,n()(e),{headers:{Authorization:this.token,"content-type":"application/json"}}).then(function(t){var a=t.data;if(1!==a.code)return s.showTip(a.msg),void setTimeout(function(){s.$router.push({path:"/index"})},1500);2==e.goodsChannel?a.content.exchange?a.content.exchange.userIntegral>=a.content.exchange.goodsIntegral?(s.payPrice=a.content.payPrice,s.goodsIntegral=a.content.exchange.goodsIntegral):(s.showTip("兑换积分不足"),s.isUseIntegral="0",s.goodsIntegral="",s.payPrice=a.content.payPrice):(s.showTip("该商品暂不支持积分兑换"),s.isUseIntegral="0",s.goodsIntegral="",s.payPrice=a.content.payPrice):(s.goodsIntegral="",s.payPrice=a.content.payPrice)}).catch(function(s){}),this.payPrice}}),beforeCreate:function(){document.title="结算"},created:function(){this.getCartList(),this.exchangeData();var s=this.autoAddress,e=this.choseAddress;e?(this.showAddress=e,this.userAddressId=this.showAddress.id,this.areaId=this.showAddress.areaId):s?(this.showAddress=s,this.userAddressId=this.showAddress.id,this.areaId=this.showAddress.areaId):this.getAutoAddress()},methods:{closePickerBox:function(){this.show=!1},showTips:function(){this.show=!0},exchangeData:function(){var s=this,e={goodsCarts:this.goodsCarts,goodsChannel:2,isUseIntegral:1,userCouponIds:this.userCouponIds};this.$axios.post(this.api.orderPriceNew,n()(e),{headers:{Authorization:this.token,"content-type":"application/json"}}).then(function(e){var t=e.data;1===t.code?t.content.exchange&&(s.exchangeObj=t.content):s.showTip(t.msg)}).catch(function(s){})},getCartList:function(){var s=[];if(this.$route.params.selectArr?(s=this.$route.params.selectArr,sessionStorage.setItem("selectArr",n()(this.$route.params.selectArr))):s=JSON.parse(sessionStorage.getItem("selectArr")),s&&s.length>0){this.isShowList=!0,this.goodsBuyInfo=s;var e=!0,t=!1,a=void 0;try{for(var o,r=i()(s);!(e=(o=r.next()).done);e=!0){var c=o.value;this.goodsCarts.push({id:c.id})}}catch(s){t=!0,a=s}finally{try{!e&&r.return&&r.return()}finally{if(t)throw a}}}else this.isShowList=!1},getAutoAddress:function(){var s=this;this.$axios.get(this.api.getDefAddrData,{headers:{Authorization:this.token}}).then(function(e){var t=e.data;t.content&&t.content.id&&(s.showAddress=t.content,s.areaId=s.showAddress.areaId,s.userAddressId=s.showAddress.id)})},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){var e=16*Math.random()|0;return("x"==s?e:3&e|8).toString(16)})},makeOrder:function(){var s=this,e=this.goodsBuyInfo,t=this.showAddress;if(0!==e.length)if(t){var a={areaId:this.areaId,channel:2,goodsCarts:this.goodsCarts,isUseIntegral:this.isUseIntegral,remark:this.goodsTips,userAddressId:this.userAddressId,userCouponIds:this.userCouponIds,uuid:this.guid()};this.$axios.post(this.api.getOrderForm,n()(a),{headers:{Authorization:this.token,"content-type":"application/json"}}).then(function(e){var t=e.data;if(1===t.code){var a=t.content;s.$router.push({path:"/goods/pay",query:{orderNumbers:a,payPrice:s.payPrice}})}else s.showTip(t.msg)}).catch(function(e){s.showTip("下单失败，请您稍后重试")})}else this.showTip("请选择收货地址");else this.showTip("未获取到商品信息")}}}),x={render:function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("div",{staticClass:"wrapper page-buy"},[t("vHeader",{attrs:{title:"填写订单"}}),s._v(" "),s.isShowList?t("router-link",{staticClass:"lay-address white mb10 mt50",attrs:{to:{path:"/mine/addresses",query:{from:"goods"}}}},[t("i",{staticClass:"ico i-map"}),s._v(" "),t("div",{staticClass:"adress"},[s.showAddress?[t("span",{staticClass:"name-phone fs-14"},[s._v(s._s(s.showAddress.userName)+" "+s._s(s.showAddress.phone))]),s._v(" "),t("span",{staticClass:"adres fs-12 txt-gray"},[s._v(s._s(s.showAddress.areaInfo)+" "+s._s(s.showAddress.address))])]:t("span",{staticClass:"chose"},[s._v("选择收货地址")])],2),s._v(" "),t("i",{staticClass:"ico i-aow"})]):s._e(),s._v(" "),s.isShowList?t("div",{staticClass:"lay-goods white mb10 pd15"},s._l(s.goodsBuyInfo,function(e,a){return t("div",{key:a,staticClass:"item"},[t("div",{staticClass:"img-box"},[t("img",{staticClass:"img",attrs:{src:e.img}})]),s._v(" "),t("div",{staticClass:"info-box"},[t("div",{staticClass:"title"},[s._v("\n          "+s._s(e.name)+"\n        ")]),s._v(" "),t("div",{staticClass:"price-num"},[t("span",{staticClass:"price"},[s._v("￥"+s._s(e.price))]),s._v(" "),t("span",{staticClass:"fs-12"},[s._v("x "+s._s(e.num))])])])])}),0):s._e(),s._v(" "),t("group",[t("div",{on:{click:s.showTips}},[t("cell",{attrs:{title:s.exchangeObj&&s.exchangeObj.discountedPrice?"可使用兑换积分"+s.exchangeObj.discountedPrice+".00":"可使用兑换积分0.00","is-link":""}},[t("img",{staticStyle:{display:"block","margin-right":"5px",width:"25px",height:"25px"},attrs:{slot:"icon",src:s.exchangePic},slot:"icon"})])],1)]),s._v(" "),s.exchangeObj?t("div",{staticClass:"picker-new"},[t("div",{class:s.show?"picker-mask show":"picker-mask",on:{click:s.closePickerBox}}),s._v(" "),t("div",{class:s.show?"picker-panel show":"picker-panel"},[t("div",{staticClass:"h45 vux-1px-b relative titleEx"},[s._v("兑换积分"),t("i",{staticClass:"txt-gray",on:{click:s.closePickerBox}},[s._v("×")])]),s._v(" "),t("div",{staticClass:"groupEx mb10 justify-content-space-between pda15"},[t("span",{staticClass:"left",domProps:{textContent:s._s("可使用兑换积分"+s.exchangeObj.exchange.goodsIntegral*s.exchangeObj.goodsCount)}}),s._v(" "),t("input",{directives:[{name:"model",rawName:"v-model",value:s.isUseIntegral,expression:"isUseIntegral"}],staticClass:"check goods-check goodsCheck",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(s.isUseIntegral)?s._i(s.isUseIntegral,null)>-1:s.isUseIntegral},on:{change:function(e){var t=s.isUseIntegral,a=e.target,i=!!a.checked;if(Array.isArray(t)){var o=s._i(t,null);a.checked?o<0&&(s.isUseIntegral=t.concat([null])):o>-1&&(s.isUseIntegral=t.slice(0,o).concat(t.slice(o+1)))}else s.isUseIntegral=i}}})])])]):s._e(),s._v(" "),s.isShowList?t("div",{staticClass:"lay-tips white"},[t("textarea",{directives:[{name:"model",rawName:"v-model",value:s.goodsTips,expression:"goodsTips"}],staticClass:"txa",attrs:{placeholder:"请填写备注",maxlength:"200"},domProps:{value:s.goodsTips},on:{input:function(e){e.target.composing||(s.goodsTips=e.target.value)}}})]):s._e(),s._v(" "),s.isShowList?t("div",{staticClass:"lay-action fix-btom pay-act-btom"},[t("div",{staticClass:"price-info flex1"},[t("span",{staticClass:"tag"},[s._v("合计：")]),s._v(" "),t("span",{staticClass:"total",model:{value:s.num,callback:function(e){s.num=e},expression:"num"}},[s._v("￥"+s._s(s.totalPrice))]),s._v(" "),t("span",{staticClass:"tip"},[s._v(" (含运费)")])]),s._v(" "),t("button",{staticClass:"btn-submit per40",on:{click:s.makeOrder}},[s._v("支付订单")])]):s._e(),s._v(" "),s.isShowList?s._e():t("v-nodata",{attrs:{bgcolor:"grey",text:"- 暂无待支付订单 -"}})],1)},staticRenderFns:[]};var A=t("C7Lr")(v,x,!1,function(s){t("j04V")},null,null);e.default=A.exports},j04V:function(s,e){}});
//# sourceMappingURL=15.1ea6a144714442872024.js.map