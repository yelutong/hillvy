webpackJsonp([20],{EWEZ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("3cXf"),i=n.n(o),s=n("4YfN"),a=n.n(s),c=n("9rMa"),d=n("wSez"),r=n("UzLt"),h=(n("6iV/"),r.a,a()({},Object(c.c)(["token","userId","parentId"])),a()({},Object(c.b)(["atnOpenId","atnToken","atnProUserId"]),{getCode:function(){var e=this,t=this.bindInfo;t.hasSend||(11===t.phone.length?this.$axios.get(this.api.getVerifyCode+t.phone).then(function(t){var n=t.data;1===n.code?(e.bindInfo.hasSend=!0,e.showTip("验证码已发送到您的手机，请注意查收"),e.countDownTime()):e.showTip(n.message)}).catch(function(t){e.showTip("获取验证码失败，请稍后重试")}):this.showTip("手机号码格式不正确"))},countDownTime:function(){var e=this;!function t(){var n=setTimeout(function(){e.bindInfo.time<=0?(clearTimeout(n),e.bindInfo.hasSend=!1,e.bindInfo.time=120):(e.bindInfo.time-=1,t())},1e3)}()},bindPhone:function(){var e=this,t=this.bindInfo;if(11===t.phone.length)if(""!==t.code){var n=Object(d.Toast)({message:"绑定中...",iconClass:"loading",duration:3e4}),o=localStorage.getItem("bindInfo");(o=JSON.parse(o)).username=t.phone,o.smsCode=t.code,o.proUserId=localStorage.getItem("proUserId");this.$axios.post(this.api.wxBind+"",i()(o),{headers:{"content-type":"application/json"}}).then(function(t){n.close();var o=t.data;1===o.code?e.setUserIdBack(o.content):e.showTip(o.message)}).catch(function(t){n.close(),e.showTip("绑定失败，请稍后重试")})}else this.showTip("请输入验证码");else this.showTip("手机号码格式不正确")},setUserIdBack:function(e){this.atnToken(e),localStorage.setItem("token",e);Object(d.Toast)({message:"绑定成功！",iconClass:"ok",duration:2e3});this.$router.push("/mine")},ifUserBind:function(e){var t=this;this.$axios.get(this.api.getUserInfo,{headers:{Authorization:e}}).then(function(e){var n=e.data;1===n.code&&n.content&&t.setUserIdBack(n.content)})}}),n("6iV/"),{data:function(){return{bindInfo:{phone:"",code:"",time:60,hasSend:!1},headimgurl:"",nickname:"",proUserId:"",sex:""}},components:{vHeader:r.a},computed:a()({},Object(c.c)(["token","userId","parentId"])),beforeCreate:function(){document.title="手机登录"},created:function(){},methods:a()({},Object(c.b)(["atnOpenId","atnToken","atnProUserId"]),{getCode:function(){var e=this,t=this.bindInfo;t.hasSend||(11===t.phone.length?this.$axios.get(this.api.getVerifyCode+t.phone).then(function(t){var n=t.data;1===n.code?(e.bindInfo.hasSend=!0,e.showTip("验证码已发送到您的手机，请注意查收"),e.countDownTime()):e.showTip(n.message)}).catch(function(t){e.showTip("获取验证码失败，请稍后重试")}):this.showTip("手机号码格式不正确"))},countDownTime:function(){var e=this;!function t(){var n=setTimeout(function(){e.bindInfo.time<=0?(clearTimeout(n),e.bindInfo.hasSend=!1,e.bindInfo.time=120):(e.bindInfo.time-=1,t())},1e3)}()},bindPhone:function(){var e=this,t=this.bindInfo;if(11===t.phone.length)if(""!==t.code){var n=Object(d.Toast)({message:"绑定中...",iconClass:"loading",duration:3e4}),o=localStorage.getItem("bindInfo");(o=JSON.parse(o)).username=t.phone,o.smsCode=t.code,o.proUserId=localStorage.getItem("proUserId");this.$axios.post(this.api.wxBind+"",i()(o),{headers:{"content-type":"application/json"}}).then(function(t){n.close();var o=t.data;1===o.code?e.setUserIdBack(o.content):e.showTip(o.message)}).catch(function(t){n.close(),e.showTip("绑定失败，请稍后重试")})}else this.showTip("请输入验证码");else this.showTip("手机号码格式不正确")},setUserIdBack:function(e){this.atnToken(e),localStorage.setItem("token",e);Object(d.Toast)({message:"绑定成功！",iconClass:"ok",duration:2e3});this.$router.push("/mine")},ifUserBind:function(e){var t=this;this.$axios.get(this.api.getUserInfo,{headers:{Authorization:e}}).then(function(e){var n=e.data;1===n.code&&n.content&&t.setUserIdBack(n.content)})}})}),u={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper white page-bind"},[n("vHeader",{attrs:{title:"绑定"}}),e._v(" "),n("div",{staticClass:"item-bind"},[n("i",{staticClass:"ico i-phone"}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.bindInfo.phone,expression:"bindInfo.phone",modifiers:{trim:!0}}],staticClass:"ipt",attrs:{type:"number",placeholder:"请输入手机号",maxlength:"11"},domProps:{value:e.bindInfo.phone},on:{input:function(t){t.target.composing||e.$set(e.bindInfo,"phone",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}})]),e._v(" "),n("div",{staticClass:"item-bind"},[n("i",{staticClass:"ico i-lock"}),e._v(" "),n("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.bindInfo.code,expression:"bindInfo.code",modifiers:{trim:!0}}],staticClass:"ipt",attrs:{type:"number",placeholder:"请输入验证码",maxlength:"11"},domProps:{value:e.bindInfo.code},on:{input:function(t){t.target.composing||e.$set(e.bindInfo,"code",t.target.value.trim())},blur:function(t){e.$forceUpdate()}}}),e._v(" "),e.bindInfo.hasSend?e._e():n("button",{staticClass:"btn-submit btn-code",on:{click:e.getCode}},[e._v("获取验证码")]),e._v(" "),e.bindInfo.hasSend?n("div",{staticClass:"cut-time"},[e._v("剩余 "+e._s(e.bindInfo.time)+" s")]):e._e()]),e._v(" "),n("button",{staticClass:"btn-submit btn-bind flex1",on:{click:e.bindPhone}},[e._v("绑 定")])],1)},staticRenderFns:[]};var f=n("C7Lr")(h,u,!1,function(e){n("uSnI")},null,null);t.default=f.exports},uSnI:function(e,t){}});
//# sourceMappingURL=20.dae713dd35ce5acdbec7.js.map