$(document).ready(function(){$(window).scroll(function(){t=$(document).scrollTop();if(t>200){$("#gotop").fadeIn("slow")}else{$("#gotop").fadeOut("slow")}});$("#gotop").click(function(){$("body,html").animate({scrollTop:0},800);return false});$(".right-icon em").html(sessionStorage.getItem("carGoodsNumber"))});var useragent=navigator.userAgent;if(navigator.userAgent.indexOf("mcyou")>=0){$(".header-box,footer,.od_bottom").hide();$(".content").css("margin",0);$(".od_detail,.ct_other").removeClass("content");$("#wx_code_21").hide()}function imagetoCanvas(image,type,width,quality){var img=new Image(),src=image.src;img.crossOrigin="anonymous";img.src=src;if(src&&src.indexOf("data:image")>-1){return false}else{img.onload=function(){var cvs=document.createElement("canvas");var ctx=cvs.getContext("2d");var scale=image.width/image.height;cvs.width=width;cvs.height=parseInt(cvs.width/scale);ctx.drawImage(img,0,0,cvs.width,cvs.height);if(quality&&quality<=1&&quality>0){quality=quality}else{quality=0.5}var cropStr=cvs.toDataURL(type,quality);image.setAttribute("src",cropStr)}}}function showmessage(msg){$("#Msg").show();$("#Msg").html('<div style="position: fixed;z-index:99999991;padding:10px;width: 150px;min-height:40px;background: #222;color: #fff;left: 50%;border-radius: 0.6em;z-index: 9999999999;'+'line-height: 80px;margin-left: -75px;word-break: break-all;text-align: center;top: 40%;opacity: .7;text-shadow: 0 1px 0 #111;height: auto;">'+'<p id="alert_message" style="line-height:20px;margin:10px 0 10px 0;color:#FFF">'+msg+"</p>"+"</div>");setTimeout(closemessage,2000)}function showmessageTop(msg){$("#Msg").show();$("#Msg").html('<div style="position: fixed;z-index:99999991;padding:10px;width: 150px;min-height:40px;background: #222;color: #fff;left: 50%;border-radius: 0.6em;'+'line-height: 80px;margin-left: -75px;word-break: break-all;text-align: center;top:80px;opacity: .7;text-shadow: 0 1px 0 #111;height: auto;">'+'<p id="alert_message" style="line-height:20px;margin:10px 0 10px 0;color:#FFF">'+msg+"</p>"+"</div>");setTimeout(closemessage,2000)}function closemessage(){$("#Msg").hide()}jQuery.fn.widH=function(){var width=$(this).width();$(this).css("height",width)};$(document).ready(function(){var $divWidth=$(".od_detail div img.video").width();$(".od_detail div video").css({"height":$divWidth,"width":$divWidth});$(".od_detail div img.video").click(function(){$(this).hide();$(".videoInfo").each(function(i,v){$(".videoInfo")[i].pause()});var $vd=$(this).next("video");$vd.show();var md=$vd[0];md.play()});$(".right-icon em").html(sessionStorage.getItem("carGoodsNumber"))});function launchFullscreen(element){if(element.requestFullscreen){element.requestFullscreen()}else{if(element.mozRequestFullScreen){element.mozRequestFullScreen()}else{if(element.msRequestFullscreen){element.msRequestFullscreen()}else{if(element.oRequestFullscreen){element.oRequestFullscreen()}else{if(element.webkitRequestFullscreen){element.webkitRequestFullScreen()}else{var docHtml=document.documentElement;var docBody=document.body;var videobox=document.getElementById("videobox");var cssText="width:100%;height:100%;overflow:hidden;";docHtml.style.cssText=cssText;docBody.style.cssText=cssText;videobox.style.cssText=cssText+";"+"margin:0px;padding:0px;";document.IsFullScreen=true}}}}}}function vide(obj){var md=document.getElementById(obj);md.addEventListener("ended",function(){$(this).hide();$(this).prev("img").show()});md.addEventListener("isFullscreenchange",function(e){if(!document.isFullScreen){$(this).hide();$(this)[0].pause();$(this).prev("img").show()}});md.addEventListener("msfullscreenchange",function(e){if(!document.msfullScreen){$(this).hide();$(this)[0].pause();$(this).prev("img").show()}});md.addEventListener("ofullscreenchange",function(e){if(!document.ofullScreen){$(this).hide();$(this)[0].pause();$(this).prev("img").show()}});md.addEventListener("webkitfullscreenchange",function(e){if(!document.webkitIsFullScreen){$(this).hide();$(this)[0].pause();$(this).prev("img").show()}});md.addEventListener("mozfullscreenchange",function(e){if(!document.mozFullScreen){$(this).hide();$(this)[0].pause();$(this).prev("img").show()}});md.addEventListener("pause",function(e){$(this).hide();$(this)[0].pause();$(this).prev("img").show()});md.addEventListener("webkitfullscreenchange",function(){if(runPrefixMethod(document,"FullScreen")||runPrefixMethod(document,"IsFullScreen")){}else{if(runPrefixMethod(this,"RequestFullScreen")){}}});md.addEventListener("msfullscreenchange",function(){if(runPrefixMethod(document,"FullScreen")||runPrefixMethod(document,"IsFullScreen")){}else{if(runPrefixMethod(this,"RequestFullScreen")){}}});md.addEventListener("ofullscreenchange",function(){if(runPrefixMethod(document,"FullScreen")||runPrefixMethod(document,"IsFullScreen")){}else{if(runPrefixMethod(this,"RequestFullScreen")){}}})}var runPrefixMethod=function(element,method){var usablePrefixMethod;["webkit","moz","ms","o",""].forEach(function(prefix){if(usablePrefixMethod){return
}if(prefix===""){method=method.slice(0,1).toLowerCase()+method.slice(1)}var typePrefixMethod=typeof element[prefix+method];if(typePrefixMethod+""!=="undefined"){if(typePrefixMethod==="function"){usablePrefixMethod=element[prefix+method]()}else{usablePrefixMethod=element[prefix+method]}}});return usablePrefixMethod};function toOdDetail(obj){var useragent=navigator.userAgent;if(navigator.userAgent.indexOf("ouyanghehe")>=0){window.webkit.messageHandlers.changeWebViewTitle.postMessage({"title":obj});return false}else{if(navigator.userAgent.indexOf("mcyou")>=0){window.jsBridge.onSwitchGoodsDetail(obj)}else{toDetail(obj)}}}function toHDetail(couponId,couponType){var useragent=navigator.userAgent;if(navigator.userAgent.indexOf("ouyanghehe")>=0){window.webkit.messageHandlers.takeCoupon.postMessage({"couponId":couponId,"couponType":couponType});return false}else{if(navigator.userAgent.indexOf("mcyou")>=0){window.jsBridge.getCoupon('{"couponId":'+couponId+',"couponType":'+couponType+"}")}else{toH5Detail(couponId,couponType)}}}function toDetail(goodsId){window.sessionStorage.removeItem("detailExchange");window.sessionStorage.setItem("detailGoodsId",goodsId);window.location.href="detail.html"}function getQueryString(name){var reg=new RegExp("(^|&)"+name+"=([^&]*)(&|$)","i");var r=window.location.search.substr(1).match(reg);if(r!=null){return unescape(r[2])}return null}function toshare(){if(!localStorage.getItem("token")){window.location.href="login.html"}else{var ua=window.navigator.userAgent.toLowerCase();if(ua.match(/MicroMessenger/i)=="micromessenger"){$(".am-share").addClass("am-modal-active");$(".sharebg").addClass("sharebg-active")}else{showmessage("请在微信客户端中进行分享");return false}commonUtil.request({type:"POST",url:wxShareSign,data:{"url":window.location.href},dataType:"json",success:function(data){console.log(data);if(data.code==1){wx.config({debug:false,appId:data.content.appId,timestamp:data.content.timestamp,nonceStr:data.content.nonceStr,signature:data.content.signature,jsApiList:["checkJsApi","onMenuShareTimeline","onMenuShareAppMessage","onMenuShareQQ","onMenuShareQZone"]})}else{}}});wx.ready(function(){commonUtil.request({url:userShare,type:"get",contentType:"application/json",success:function(data){if(data.code==1){var onMenu={title:data.content.title,desc:data.content.content,link:data.content.url,imgUrl:photo+data.content.logPhoto};wx.checkJsApi({jsApiList:["getLocation","onMenuShareTimeline","onMenuShareAppMessage"],success:function(res){}});wx.onMenuShareQQ({title:onMenu.title,desc:onMenu.desc,link:onMenu.link,imgUrl:onMenu.imgUrl,success:function(){},cancel:function(){}});wx.onMenuShareAppMessage({title:onMenu.title,desc:onMenu.desc,link:onMenu.link,imgUrl:onMenu.imgUrl,type:"",dataUrl:"",success:function(){},cancel:function(){}});wx.onMenuShareTimeline({title:onMenu.title,link:onMenu.link,imgUrl:onMenu.imgUrl,trigger:function(res){},success:function(){},cancel:function(){}});wx.onMenuShareQZone({title:onMenu.title,desc:onMenu.desc,link:onMenu.link,imgUrl:onMenu.imgUrl,success:function(){},cancel:function(){}})}else{showmessage("分享出错");return false}}})});$("#weixin_friend,#weixin,#qq").click(function(){$(".share_wxbg").fadeIn()});wx.error(function(res){})}}$(function(){$(".sharebg,.share_btn").click(function(){$(".am-share").removeClass("am-modal-active");$(".sharebg").removeClass("sharebg-active");if($(".share_wxbg").css("display")=="block"){$(".share_wxbg").fadeOut()}})});