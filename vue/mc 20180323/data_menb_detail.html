<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
<title>数据统计</title>
<link rel="shortcut icon" href="images/favicon.ico" />
<link rel="stylesheet" href="min_css/public.css"> 
<link rel="stylesheet" href="min_css/content.css"> 
</head> 
<body>
<header class="header-box" id="header_data21">
		<div class="header-menu" id="headerMenu">
		<span class="logo">会员详情</span>
		<div class="header-icon left-icon"> 
			<a href="javascript:window.history.back()" class="icon_bk sprite" ></a>
        </div>  
         <div class="header-icon right-icon"> 
			<a href="index.html" class="icon"><img src="images/home_icon21.png"></a>
         </div>
		</div>
</header>
<div class="content data_menb">
 <div class="data_men_top data_men_top21">
 	<h3 v-text="memberDetailHead.userName"></h3>
 	<p  v-text="memberDetailHead.realName"></p> 
 	<p class="ik" v-text="userLevelDes(memberDetailHead.level)"></p>
 	<label class="buy_packge_data">套餐：<i v-text="memberDetailHead.packageCount"></i></label>
 	<ul class="data_men_ul21"> 
 		<li class="data_men_pt select_on" dataClass="data_men_direct_today">今日直推</li>
 		<li class="data_men_ck" dataClass="data_men_direct_all">直推总数</li>
 		<li class="data_men_pt" dataClass="data_men_indirect_today">今日间推</li>
 		<li class="data_men_ck" dataClass="data_men_indirect_all">间推总数</li>
 	</ul> 
 </div>
 
 	<ul class="data_men_ul23 data_men_direct_today_dt"> 
 		<li class="data_men_direct_today_pt select_on2" dataClass="data_men_direct_today_pt">普通会员(<i>*</i>)</li>
 		<li class="data_men_direct_today_ck" dataClass="data_men_direct_today_ck">创客会员(<i>*</i>)</li> 
 	</ul> 
 	 	<ul class="data_men_ul23 data_men_direct_all_dt"  style="display:none"> 
 		<li class="data_men_direct_all_pt select_on2" dataClass="data_men_direct_all_pt">普通会员(<i>*</i>)</li>
 		<li class="data_men_direct_all_ck" dataClass="data_men_direct_all_ck">创客会员(<i>*</i>)</li> 
 	</ul>
 	 	<ul class="data_men_ul23 data_men_indirect_today_dt"  style="display:none"> 
 		<li class="data_men_indirect_today_pt select_on2" dataClass="data_men_indirect_today_pt">普通会员(<i>*</i>)</li>
 		<li class="data_men_indirect_today_ck" dataClass="data_men_indirect_today_ck">创客会员(<i>*</i>)</li> 
 	</ul>
 	 	<ul class="data_men_ul23 data_men_indirect_all_dt"  style="display:none"> 
 		<li class="data_men_indirect_all_pt select_on2" dataClass="data_men_indirect_all_pt">普通会员(<i>*</i>)</li>
 		<li class="data_men_indirect_all_ck" dataClass="data_men_indirect_all_ck">创客会员(<i>*</i>)</li> 
 	</ul>
 	
 <ul class="data_men_centent01"> 
 	<li><span>普通会员</span><span>姓名</span><span>套餐</span><span>注册时间</span></li>
 </ul>	
 <div class="data_men_centent21" id="data_men_direct_today_pt">	
 <ul></ul>
 </div>
 <div class="data_men_centent21" id="data_men_direct_today_ck" style="display:none">
  <ul></ul>
 </div>
 <div class="data_men_centent21" id="data_men_direct_today_tc" style="display:none">
  <ul>
  
 </ul>
 </div>
 <div class="data_men_centent21" id="data_men_direct_all_pt" style="display:none">
  <ul> 
  
 </ul>
 </div>
 <div class="data_men_centent21" id="data_men_direct_all_ck" style="display:none">
 <ul> 
  
 </ul>
 </div>
 <div class="data_men_centent21" id="data_men_direct_all_tc" style="display:none">
  <ul> 
 	 
 </ul>
 </div>
 <div class="data_men_centent21" id="data_men_indirect_today_pt" style="display:none">
  <ul> 
 	 
 </ul>
 </div>
 <div class="data_men_centent21" id="data_men_indirect_today_ck" style="display:none">
  <ul> 
 	 
 </ul>
 </div> 
  <div class="data_men_centent21" id="data_men_indirect_all_pt" style="display:none">
   <ul> 
	 
	</ul> 
  </div>
  <div class="data_men_centent21" id="data_men_indirect_all_ck" style="display:none">
   <ul> 
 	 
 </ul>
  </div> 
</div> 
<div id="gotop">
  <div class="sprite gopic"></div> 
</div> 
		
</body>
</html>
<script type="text/javascript" src="min_js/jquery-1.10.1.min.js"></script>
<script type="text/javascript" src="min_js/publick.js"></script> 
<script type="text/javascript" src="min_js/api.js"></script>
<script type="text/javascript" src="min_js/commonUtil.js"></script>
<script type="text/javascript" src="min_js/jquery.md5.js"></script>
<script type="text/javascript" src="min_js/vue.min.js" ></script> 
<script>
	var vm = new Vue({
		el: '.data_menb',
		data: { 
           memberDetailHead:{}
		},

		created: function() { 
			
		  commonUtil.request({
				url: memberDetailHead,
				type: "post", 
				contentType: "application/json",
				data : {
						"userId":window.localStorage.getItem("data_menb_id")
					},
				success: function(data) {
					console.log(data);
					if(data.code == 1) {   
						vm.memberDetailHead = data.content; 
                        if(vm.memberDetailHead.realName==undefined){
							if(vm.memberDetailHead.nickName){
							   vm.memberDetailHead.realName=vm.memberDetailHead.nickName;
							}else{
							   vm.memberDetailHead.realName="无名";
							}
						} 
					}
				}
			}); 
		 /*commonUtil.request({
				url: memberDetailList,
				type: "post", 
				contentType: "application/json",
				data : {
						"userId":window.localStorage.getItem("data_menb_id")
					},
				success: function(data) {
					console.log(data);
					if(data.code == 1) {  
						vm.statistic = data.content; 

					}
				}
			});  */

		},
		mounted: function() { //生命期钩子 
			 /*var data_menb_id = window.localStorage.getItem("data_menb_id"); 
				if(data_menb_id) {
					//商品详情
					commonUtil.request({
						url: goodsDetail + data_menb_id, 
						type: "get",
						contentType: "application/json",
						success: function(data) {
							console.log(data);
							if(data.code == 1) {
								vm.goods = data.content;
								vm.skuPriceAndSkuStock();
								vm.lazyloadImg();
							}
						}
					});
				}*/

		},
		methods: {
            

		}

	})
</script>
<script type="text/javascript" src="min_js/dropload.min21.js"></script>
<script> 
$(function(){  
	//数据统计 
	$(".data_men_ul21 li").click(function(){ 
		$(this).addClass("select_on").siblings().removeClass("select_on");
		var obj_id=$(this).attr("dataClass"); 
		if(obj_id==window.localStorage.getItem("obj_id")){
			return false;
		}else{  
			window.localStorage.setItem("obj_id",obj_id); 
			$(".data_men_ul23").hide(); 
			$(".data_men_centent21").hide();
			$("."+obj_id+"_dt").show();
			$("."+obj_id+"_pt").addClass("select_on2").siblings().removeClass("select_on2");
			$("#"+obj_id+"_pt").show(); 


			$("#"+obj_id+"_pt ul").empty();
			$("#"+obj_id+"_pt div").remove();
			$("#"+obj_id+"_ck ul").empty();
			$("#"+obj_id+"_ck div").remove();

			var recommendType="DayDirect";
			if(obj_id.indexOf("men_direct") > 0){//直推 
				if(obj_id.indexOf("today") > 0){//今日
				   recommendType="DayDirect"; 
					pageloadAll("#data_men_direct_today_pt","data_men_direct_today_pt",1,recommendType);
				}
				if(obj_id.indexOf("all") > 0){//总数
				   recommendType="DirectTotal";
					pageloadAll("#data_men_direct_all_pt","data_men_direct_all_pt",1,recommendType); 
				}

			}
			if(obj_id.indexOf("men_indirect") > 0){//间推 
				if(obj_id.indexOf("today") > 0){//今日
				   recommendType="DayIndirect"; 
					pageloadAll("#data_men_indirect_today_pt","data_men_indirect_today_pt",1,recommendType);
				}
				if(obj_id.indexOf("all") > 0){//总数
				   recommendType="IndirectTotal";
					pageloadAll("#data_men_indirect_all_pt","data_men_indirect_all_pt",1,recommendType); 
				}

			} 
		    setTimeout(function(){ 
				window.localStorage.removeItem('obj_id');
			},1000);
	  }	 
	})
	$(".data_men_ul23 li").click(function(){ 
		$(this).addClass("select_on2").siblings().removeClass("select_on2");
		var obj_id=$(this).attr("dataClass"); 
		if(obj_id==window.localStorage.getItem("obj_id21")){
			return false;
		}else{  
			 window.localStorage.setItem("obj_id21",obj_id); 
			$(".data_men_centent21").hide();
			$("#"+obj_id).show(); 

			$("#"+obj_id+" ul").empty();
			$("#"+obj_id+" div").remove();

			if(obj_id.indexOf("pt") > 0){ 
				$(".data_men_centent01 li span:first-child").html("普通会员"); 
			}
			if(obj_id.indexOf("ck") > 0){ 
				$(".data_men_centent01 li span:first-child").html("创客会员"); 
			}

			var recommendType="DayDirect";
			if(obj_id.indexOf("men_direct") > 0){//直推 
				if(obj_id.indexOf("today") > 0){//今日
				   recommendType="DayDirect"; 
					if(obj_id.indexOf("pt") > 0){ 
					   pageloadAll("#data_men_direct_today_pt","data_men_direct_today_pt",1,recommendType); 
					}
					if(obj_id.indexOf("ck") > 0){ 
					   pageloadAll("#data_men_direct_today_ck","data_men_direct_today_ck",2,recommendType); 
					} 
				}
				if(obj_id.indexOf("all") > 0){//总数 
				   recommendType="DirectTotal";
					if(obj_id.indexOf("pt") > 0){ 
					   pageloadAll("#data_men_direct_all_pt","data_men_direct_all_pt",1,recommendType); 
					}
					if(obj_id.indexOf("ck") > 0){ 
					   pageloadAll("#data_men_direct_all_ck","data_men_direct_all_ck",2,recommendType); 
					}
					//pageloadAll("#data_men_direct_all_ck","data_men_direct_all_ck",2,recommendType); 

				}

			}
			if(obj_id.indexOf("men_indirect") > 0){//间推 
				if(obj_id.indexOf("today") > 0){//今日
				   recommendType="DayIndirect"; 
					if(obj_id.indexOf("pt") > 0){ 
					   pageloadAll("#data_men_indirect_today_pt","data_men_indirect_today_pt",1,recommendType); 
					}
					if(obj_id.indexOf("ck") > 0){ 
					   pageloadAll("#data_men_indirect_today_ck","data_men_indirect_today_ck",2,recommendType); 
					} 
				}
				if(obj_id.indexOf("all") > 0){//总数
				   recommendType="IndirectTotal";
					if(obj_id.indexOf("pt") > 0){ 
					   pageloadAll("#data_men_indirect_all_pt","data_men_indirect_all_pt",1,recommendType); 
					}
					if(obj_id.indexOf("ck") > 0){ 
					   pageloadAll("#data_men_indirect_all_ck","data_men_indirect_all_ck",2,recommendType); 
					} 
					//pageloadAll("#data_men_direct_all_ck","data_men_direct_all_ck",2,recommendType); 
				}

			} 
			
			setTimeout(function(){ 
				window.localStorage.removeItem('obj_id21');
			},1000);
		}
	});
})
pageloadAll("#data_men_direct_today_pt","data_men_direct_today_pt",1,"DayDirect"); 
function pageloadAll(dropClass,appendId,level,recommendType){	
	//总页数
	var totalPage = 1;//初始化
	//当前页
	var page = 0;

	// dropload
	$(dropClass).dropload({
		scrollArea : window,
		domDown : {
			domClass   : 'dropload-down', 
			domLoad    : '<div class="dropload-load" style="clear:both"><span class="loading"></span>加载中...</div>'
		},
		loadDownFn : function(me){  
			if(page< totalPage){
				page= parseInt(page) + 1;
				//console.log("页码"+page);
				if(page==window.localStorage.getItem("page21") && page>1){
					//console.log("重复");
					return false;
				}else{
					//console.log("存储");
					window.localStorage.setItem("page21",page);
				}  
				var result = '';
				var data={ 
						"page" : page,
						"limit":8,
					    "level":level,
					    "userId":window.localStorage.getItem("data_menb_id"),
						"recommendType":recommendType
					} 
                
			commonUtil.request({
					type: 'post',
					url: memberDetailList,

					dataType: 'json',
					cache : false,
					async : false,
					data : data,
					success: function(data){
						$("."+appendId+" i").html(data.content.totalCount);
						console.log(data);
						totalPage=data.content.totalPage; 
						if(totalPage==1||totalPage==0){
							setTimeout(function(){ 
							   $(dropClass+" .dropload-down").html("已全部加载");
							},300);
							setTimeout(function(){ 
								$(dropClass+" .dropload-down").hide();
							},500);
						}
						jQuery.each(data.content.list,function(i,v){ 
							if(v.realName==undefined){
								if(v.nickName){
								   v.realName=v.nickName;
								}else{ 
								   v.realName="无名";
								}  
							}  
							result += '<li onclick="toSee21('+v.userId+')"><span>'+v.userName+'</span><span>'+ v.realName +'</span><span>'+v.packageCount+'</span><span>'+v.createTime.substring(0,10)+'</span></li>';   
						}); 
					},
					error: function(xhr, type){
						me.resetload();
					}
				});
				setTimeout(function(){
					$("#"+appendId+" ul").append(result);
					me.resetload(); 
				},300);

			}else{
				$(dropClass+" .dropload-down").html("已全部加载");
				setTimeout(function(){
					$(dropClass+" .dropload-down").hide();
				},500);
			}
		}
	});
}
function toSee21(data_menb_detail_id){
	window.localStorage.setItem("data_menb_detail_id", data_menb_detail_id);
	window.location.href = "#";
}	
</script>